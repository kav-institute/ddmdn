{
    "paths":
    {
        "data_path": "/workspace/data/full/ind/database",
        "topview_path": "/workspace/data/full/ind/topview",
        "result_path": "/workspace/data/trained_models"
    },
    "common": 
    {
        "device": "cuda",
        "gpuid": 0,
        "dataset": "ind_full",
        "random_seed": 31,
        "context_radius": 10,
        "context_scale": 12,
        "input_delta_t": 0.1,
        "output_delta_t": 0.5,
        "input_horizon": 10,
        "output_horizons": [4,9,14,19,24,29,34,39],
        "temporal_reweight": [1.0, 1.25, 1.5, 2.0, 2.5, 3.0, 4.0, 5.0],
        "num_modes": 7,
        "num_hypos": 20,
        "min_k_per_mode": 2,
        "num_top_hypos": 5,
        "hypos_confidence_filter": 0.1
    },
    "grid":
    {
        "size_meter": 10,
        "full_cell_size": 128
    },
    "model": 
    {
        "early_stopping_patience": 50,
        "with_spatial_encoder": true,
        "with_discrete_pipeline": true,
        "with_discrete_social_encoder": true,
        "with_dynamic_modes": true,

        "temporal_encoder_layer": "ConvAttnLSTM_Encoder",
        "temporal_encoder_in_dim": 6,
        "temporal_encoder_num_layers": 1,
        "temporal_encoder_out_dim": 64,
        "temporal_encoder_bidirectional": false,
        "temporal_encoder_with_spatial": false,
        "temporal_encoder_conv_out_dim": 16,
        "temporal_encoder_conv_kernel": 3,
        "temporal_encoder_conv_stride": 1,
        "temporal_encoder_conv_padding": 1,
        "temporal_encoder_attn_nheads": 2,
        "temporal_encoder_attn_layer_size": 2,
        "temporal_encoder_dropout": 0.3,

        "cnn_encoder_layer": "CNNEncoder",
        "cnn_encoder_in_dim": 3,
        "cnn_encoder_out_dim": 64,
        "cnn_encoder_layer_size": 1,
        "cnn_encoder_nheads": 2,
        "cnn_encoder_dropout": 0.3,

        "mdn_mixture_typ": "MDN_MultivariateNormal",
        "mdn_mixture_layer": "MixtureDiffusion",
        "mdn_variance_epsilon": 1e-5,
        "mdn_mlp_activation": "ReLU",
        "mdn_mlp_hidden_dim": [512],
        "mdn_mlp_out_dim": 512,
        "mdn_mlp_dropout": 0.3,
        "mdn_diffusion_steps": 96,
        "mdn_diffusion_beta_start": 2e-4,
        "mdn_diffusion_beta_end": 5e-2,
        "mdn_diffusion_mode": "cosine",
        "mdn_diffusion_layer_size": 2,
        "mdn_diffusion_nheads": 2,
        "mdn_diffusion_d_model": 32,
        "mdn_diffusion_ff_dim": 64,
        "mdn_diffusion_dropout": 0.1,
        "mdn_diffusion_importance_sampling": true,
        "mdn_diffusion_importance_sampling_decay": 0.99,
        "mdn_diffusion_sampling_method": "dpm_ode",
        "mdn_diffusion_dpm_solver_order": 3,
        "mdn_diffusion_sampling_steps": 8,

        "social_encoder_layer": "SocialOutWayEncoder",
        "social_encoder_in_dim": 64,
        "social_encoder_model_dim": 64,
        "social_encoder_ff_dim": 128,
        "social_encoder_out_dim": 64,
        "social_encoder_head_size": 2,
        "social_encoder_layer_size": 2,
        "social_encoder_dropout": 0.3,

        "discrete_generator_decoder_var_hidden_dim": [512,384],
        "discrete_generator_encoder_scale_hidden_dim": [4,16],
        "discrete_generator_scale_out_dim": 32,
        "discrete_generator_mlp_activation": "ReLU",
        "discrete_generator_mlp_dropout": 0.1
    },
    "train": 
    {
        "train_with_dynamic_input_horizon": true,
        "train_min_input_horizon": 1,
        "train_max_input_horizon": 10,
        "eval_with_dynamic_input_horizon": false,
        "eval_min_input_horizon": 1,
        "eval_max_input_horizon": 10,
        "eval_step": 1,
        "resume_train": false,
        "train_weights": "model_weights_latest.pt",
        "dataloader_train_size": 1.0,
        "dataloader_eval_size": 1.0,
        "dataloader_num_workers": 2,
        "dataloader_prefetch": 2,
        "dataloader_pin_memory": true,
        "train_batch_size": 256,
        "train_mini_batch_size": 16,
        "eval_batch_size": 512,
        "eval_mini_batch_size": 16,
        "confidence_levels": [0.95, 0.68],
        "lr_scheduler": "cosine",
        "num_total_epochs": 50,
        "warmup_epochs": 1,
        "cooldown_epochs": 1,
        "plateau_factor": 0.5,
        "plateau_patience": 10,
        "start_learning_rate": 3e-4,
        "final_learning_rate": 3e-5,
        "lambda_per_anchor_nll": 0.05,
        "lambda_per_step_nll": 1.0,
        "lambda_d_minmse": 0.75,
        "lambda_d_inside": 0.5,
        "inside_quantile": 0.975,
        "lambda_d_wta": 0.25, 
        "wta_tau": [1.0, 0.1],
        "prune_delta": [0.025, 0.1],
        "prune_tau": [1.0, 0.05],
        "top_p_truncation": [1.0, 0.9],
        "weight_decay": 1e-4,
        "clip_grad_norm": 1.0,
        "num_samples": 1000,
        "auto_save_step": 1
    },
    "vis": 
    {   
        "plot_reliability": true,
        "plot_reliability_step": 10,
        "plot_train_examples": false,
        "plot_eval_examples": false,
        "plot_epoch_step": 10,
        "plot_batch_step": 64,
        "plot_instance_step": 32,
        "plot_output_horizons": [0,4,9,14,19,24,29,34,39]
    },
    "test": 
    {
        "test_with_dynamic_input_horizon": false,
        "test_min_input_horizon": 1,
        "test_max_input_horizon": 10,
        "model_weights": "model_weights_best.pt",
        "dataloader_size": 1.0,
        "test_batch_size": 512,
        "test_mini_batch_size": 16,
        "dataloader_num_workers": 2,
        "dataloader_prefetch": 2,
        "dataloader_pin_memory": true,
        "confidence_levels": [0.95, 0.68],
        "num_samples": 1000,
        "plot_per_step_examples": false,
        "plot_per_traj_examples": false,
        "plot_batch_step": 2,
        "plot_instance_step": 128,
        "plot_reliability": true
    }
}